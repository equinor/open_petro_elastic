import pytest
from open_petro_elastic.material.span_wagner.carbon_dioxide import carbon_dioxide_density, carbon_dioxide_pressure


# Input values are extracted from Table 35 of Span & Wagner [2]
@pytest.mark.parametrize(
    "temperature, pressure, density",
    [
        # 0.05 MPa
        [186.436, 0.05, 1.4370],
        [190, 0.05, 1.4089],
        [200, 0.05, 1.3359],
        [210, 0.05, 1.2704],
        [220, 0.05, 1.2112],
        [230, 0.05, 1.1575],
        [240, 0.05, 1.1084],
        [250, 0.05, 1.0634],
        [260, 0.05, 1.0219],
        [270, 0.05, 0.98360],
        [280, 0.05, 0.94810],
        [290, 0.05, 0.91510],
        [300, 0.05, 0.88434],
        [325, 0.05, 0.81585],
        [350, 0.05, 0.75726],
        [375, 0.05, 0.70656],
        [400, 0.05, 0.66224],
        [425, 0.05, 0.62317],
        [450, 0.05, 0.58847],
        [475, 0.05, 0.55743],
        [500, 0.05, 0.52951],
        [525, 0.05, 0.50426],
        [550, 0.05, 0.48130],
        [575, 0.05, 0.46035],
        [600, 0.05, 0.44115],
        [700, 0.05, 0.37809],
        [800, 0.05, 0.33081],
        [900, 0.05, 0.29404],
        [1000, 0.05, 0.26463],
        [1100, 0.05, 0.24057],
        # 0.1 MPa
        [194.525, 0.1, 2.7796],
        [200, 0.1, 2.6980],
        [210, 0.1, 2.5617],
        [220, 0.1, 2.4394],
        [230, 0.1, 2.3288],
        [240, 0.1, 2.2282],
        [250, 0.1, 2.1363],
        [260, 0.1, 2.0519],
        [270, 0.1, 1.9741],
        [280, 0.1, 1.9021],
        [290, 0.1, 1.8352],
        [300, 0.1, 1.7730],
        [325, 0.1, 1.6348],
        [350, 0.1, 1.5167],
        [375, 0.1, 1.4147],
        [400, 0.1, 1.3257],
        [425, 0.1, 1.2472],
        [450, 0.1, 1.1776],
        [475, 0.1, 1.1154],
        [500, 0.1, 1.0594],
        [525, 0.1, 1.0088],
        [550, 0.1, 0.96283],
        [575, 0.1, 0.92087],
        [600, 0.1, 0.88242],
        [700, 0.1, 0.75619],
        [800, 0.1, 0.66158],
        [900, 0.1, 0.58803],
        [1000, 0.1, 0.52921],
        [1100, 0.1, 0.48109],
        # 1.00 MPa
        [216.695, 1, 1179.10],
        [220, 1, 1167.03],
        [225, 1, 1148.32],
        [230, 1, 1128.97],
        [233.028, 1, 1116.90],
        [233.028, 1, 26.006],
        [235, 1, 25.665],
        [240, 1, 24.857],
        [245, 1, 24.117],
        [250, 1, 23.435],
        [255, 1, 22.803],
        [260, 1, 22.215],
        [265, 1, 21.664],
        [270, 1, 21.147],
        [275, 1, 20.660],
        [280, 1, 20.199],
        [285, 1, 19.763],
        [290, 1, 19.349],
        [295, 1, 18.955],
        [300, 1, 18.579],
        [305, 1, 18.221],
        [310, 1, 17.878],
        [315, 1, 17.549],
        [320, 1, 17.234],
        [325, 1, 16.932],
        [330, 1, 16.641],
        [335, 1, 16.361],
        [340, 1, 16.092],
        [345, 1, 15.832],
        [350, 1, 15.581],
        [360, 1, 15.105],
        [370, 1, 14.659],
        [380, 1, 14.241],
        [390, 1, 13.848],
        [400, 1, 13.477],
        [410, 1, 13.127],
        [420, 1, 12.796],
        [430, 1, 12.482],
        [440, 1, 12.183],
        [450, 1, 11.899],
        [460, 1, 11.629],
        [470, 1, 11.371],
        [480, 1, 11.125],
        [490, 1, 10.889],
        [500, 1, 10.664],
        [525, 1, 10.141],
        [550, 1, 9.6675],
        [575, 1, 9.2375],
        [600, 1, 8.8449],
        [625, 1, 8.4849],
        [650, 1, 8.1535],
        [675, 1, 7.8474],
        [700, 1, 7.5638],
        [800, 1, 6.6102],
        [900, 1, 5.8718],
        [1000, 1, 5.2826],
        [1100, 1, 4.8014],
        # 10 MPa
        [218.600, 10, 1190.34],
        [220, 10, 1185.63],
        [225, 10, 1168.59],
        [230, 10, 1151.15],
        [235, 10, 1133.28],
        [240, 10, 1114.92],
        [245, 10, 1095.99],
        [250, 10, 1076.42],
        [255, 10, 1056.11],
        [260, 10, 1034.95],
        [265, 10, 1012.80],
        [270, 10, 989.46],
        [280, 10, 938.22],
        [285, 10, 909.56],
        [290, 10, 878.06],
        [295, 10, 842.67],
        [300, 10, 801.62],
        [305, 10, 751.67],
        [310, 10, 685.77],
        [315, 10, 586.02],
        [320, 10, 448.28],
        [325, 10, 358.04],
        [330, 10, 310.25],
        [335, 10, 280.11],
        [340, 10, 258.62],
        [345, 10, 242.11],
        [350, 10, 228.80],
        [360, 10, 208.25],
        [370, 10, 192.74],
        [380, 10, 180.38],
        [390, 10, 170.18],
        [400, 10, 161.53],
        [410, 10, 154.05],
        [420, 10, 147.48],
        [430, 10, 141.63],
        [440, 10, 136.39],
        [450, 10, 131.63],
        [460, 10, 127.30],
        [470, 10, 123.32],
        [480, 10, 119.65],
        [490, 10, 116.24],
        [500, 10, 113.07],
        [525, 10, 106.01],
        [550, 10, 99.930],
        [575, 10, 94.626],
        [600, 10, 89.941],
        [625, 10, 85.761],
        [650, 10, 81.999],
        [675, 10, 78.592],
        [700, 10, 75.486],
        [800, 10, 65.349],
        [900, 10, 57.759],
        [1000, 10, 51.825],
        [1100, 10, 47.040],
        # 100 MPa
        [236.031, 100, 1265.83],
        [240, 100, 1257.21],
        [245, 100, 1246.37],
        [250, 100, 1235.57],
        [255, 100, 1224.80],
        [260, 100, 1214.06],
        [265, 100, 1203.36],
        [270, 100, 1192.69],
        [275, 100, 1182.06],
        [280, 100, 1171.46],
        [285, 100, 1160.90],
        [290, 100, 1150.37],
        [295, 100, 1139.89],
        [300, 100, 1129.45],
        [305, 100, 1119.04],
        [310, 100, 1108.69],
        [315, 100, 1098.38],
        [320, 100, 1088.12],
        [325, 100, 1077.91],
        [335, 100, 1057.66],
        [340, 100, 1047.62],
        [345, 100, 1037.64],
        [350, 100, 1027.73],
        [360, 100, 1008.12],
        [370, 100, 988.80],
        [380, 100, 969.80],
        [390, 100, 951.13],
        [400, 100, 932.81],
        [410, 100, 914.87],
        [420, 100, 897.31],
        [430, 100, 880.14],
        [440, 100, 863.37],
        [450, 100, 847.00],
        [460, 100, 831.05],
        [470, 100, 815.51],
        [480, 100, 800.39],
        [490, 100, 785.67],
        [500, 100, 771.37],
        [525, 100, 737.38],
        [550, 100, 705.86],
        [575, 100, 676.71],
        [600, 100, 649.77],
        [625, 100, 624.90],
        # 800 MPa
        [327.673, 800, 1495.70],
        [330, 800, 1493.71],
        [335, 800, 1489.46],
        [340, 800, 1485.25],
        [345, 800, 1481.08],
        [350, 800, 1476.96],
        [360, 800, 1468.83],
        [370, 800, 1460.85],
        [380, 800, 1453.03],
        [390, 800, 1445.35],
        [400, 800, 1437.82],
        [410, 800, 1430.42],
        [420, 800, 1423.15],
        [430, 800, 1416.00],
        [440, 800, 1408.98],
        [450, 800, 1402.08],
        [460, 800, 1395.29],
        [470, 800, 1388.60],
        [480, 800, 1382.03],
        [490, 800, 1375.55],
        [500, 800, 1369.17],
        [525, 800, 1353.64],
        [550, 800, 1338.65],
        [575, 800, 1324.16],
        [600, 800, 1310.14],
        [625, 800, 1296.54],
        [650, 800, 1283.34],
        [675, 800, 1270.52],
        [700, 800, 1258.04],
        [800, 800, 1211.18],
        [900, 800, 1168.47],
        [1000, 800, 1129.16],
        [1100, 800, 1092.77],
    ],
)
def test_gas_density(temperature, pressure, density):
    """
    Tests that values calculated match that of table 35 from Span & Wagner.
    """
    assert carbon_dioxide_pressure(temperature, density) == pytest.approx(
        pressure, rel=0.01
    )
    assert carbon_dioxide_density(temperature, pressure) == pytest.approx(
        density, rel=0.01
    )
